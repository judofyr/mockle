((function(){var a;(a=function(a){function b(b){var c=d[b];c?(d[b]=0,c()):a.load&&a.load(b)}var c=a.loaded={},d={},e={};return a.use=function(a,d){typeof a=="string"&&(a=[a]);var f=a.length+1,g,h=function(){--f==0&&d&&d()};h();while(g=a.shift())c[g]?h():((e[g]||(e[g]=[])).push(h),b(g))},a.define=function(f,g,h){d[f]=function(){a.use(g||[],function(){var a,b=e[f];c[f]=1,h&&h();while(a=b&&b.shift())a()})},e[f]&&b(f)},a})(a);var b=this.Mockle=a({});b.module=function(a,c,d){b.define(a,c,function(){function c(){}c.prototype=d,d.create=function(){var a=new c;return a.initialize&&a.initialize.apply(a,arguments),a},b[a]=d}),d.setup&&b.use(a,function(){d.setup()})}})).call(this),Mockle.define("Parser",[],function(){var a=function(){function c(){this.yy={}}var a={trace:function(){},yy:{},symbols_:{error:2,main:3,contents:4,EOF:5,content:6,TEXT:7,ATCHAR:8,expr:9,"if":10,"for":11,call:12,IDENT:13,DOT:14,NUMBER:15,IF:16,LPAREN:17,RPAREN:18,if_end:19,ENDIF:20,ELSE:21,ELSEIF:22,FOR:23,IN:24,for_end:25,ENDFOR:26,CALL:27,CNAME:28,arglist:29,arg:30,COMMA:31,EQ:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"TEXT",8:"ATCHAR",13:"IDENT",14:"DOT",15:"NUMBER",16:"IF",17:"LPAREN",18:"RPAREN",20:"ENDIF",21:"ELSE",22:"ELSEIF",23:"FOR",24:"IN",26:"ENDFOR",27:"CALL",28:"CNAME",31:"COMMA",32:"EQ"},productions_:[0,[3,2],[4,1],[4,2],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[9,1],[9,3],[9,1],[10,6],[19,1],[19,3],[19,6],[11,8],[25,1],[25,3],[12,5],[12,4],[30,2],[30,4],[29,1],[29,2]],performAction:function(b,c,d,e,f,g,h){var i=g.length-1;switch(f){case 1:return g[i-1];case 2:this.$={type:"contents",children:[g[i]]};break;case 3:this.$=(g[i-1].children.push(g[i]),g[i-1]);break;case 4:this.$={type:"html",value:g[i]};break;case 5:this.$={type:"html",value:"@"};break;case 6:this.$={type:"text",value:g[i]};break;case 7:this.$=g[i];break;case 8:this.$=g[i];break;case 9:this.$=g[i];break;case 10:this.$={type:"lookup",loc:this._$,name:g[i]};break;case 11:this.$={type:"lookup",loc:h[i],name:g[i],base:g[i-2]};break;case 12:this.$={type:"number",value:g[i]};break;case 13:this.$={type:"if",cond:g[i-3],tbranch:g[i-1],fbranch:g[i]};break;case 14:this.$=null;break;case 15:this.$=g[i-1];break;case 16:this.$={type:"if",cond:g[i-3],tbranch:g[i-1],fbranch:g[i]};break;case 17:this.$={type:"for",name:g[i-5],expr:g[i-3],body:g[i-1],ebranch:g[i]};break;case 18:this.$=null;break;case 19:this.$=g[i-1];break;case 20:this.$={type:"call",loc:this._$,name:g[i-2],args:g[i-1]};break;case 21:this.$={type:"call",loc:this._$,name:g[i-1],args:[]};break;case 22:this.$=["argsplat",g[i]];break;case 23:this.$=["arg",g[i-2],g[i]];break;case 24:this.$=[g[i]];break;case 25:this.$=(g[i-1].push(g[i]),g[i-1])}},table:[{3:1,4:2,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{1:[3]},{5:[1,15],6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{5:[2,2],7:[2,2],8:[2,2],13:[2,2],15:[2,2],16:[2,2],20:[2,2],21:[2,2],22:[2,2],23:[2,2],26:[2,2],27:[2,2]},{5:[2,4],7:[2,4],8:[2,4],13:[2,4],15:[2,4],16:[2,4],20:[2,4],21:[2,4],22:[2,4],23:[2,4],26:[2,4],27:[2,4]},{5:[2,5],7:[2,5],8:[2,5],13:[2,5],15:[2,5],16:[2,5],20:[2,5],21:[2,5],22:[2,5],23:[2,5],26:[2,5],27:[2,5]},{5:[2,6],7:[2,6],8:[2,6],13:[2,6],14:[1,17],15:[2,6],16:[2,6],20:[2,6],21:[2,6],22:[2,6],23:[2,6],26:[2,6],27:[2,6]},{5:[2,7],7:[2,7],8:[2,7],13:[2,7],15:[2,7],16:[2,7],20:[2,7],21:[2,7],22:[2,7],23:[2,7],26:[2,7],27:[2,7]},{5:[2,8],7:[2,8],8:[2,8],13:[2,8],15:[2,8],16:[2,8],20:[2,8],21:[2,8],22:[2,8],23:[2,8],26:[2,8],27:[2,8]},{5:[2,9],7:[2,9],8:[2,9],13:[2,9],15:[2,9],16:[2,9],20:[2,9],21:[2,9],22:[2,9],23:[2,9],26:[2,9],27:[2,9]},{5:[2,10],7:[2,10],8:[2,10],13:[2,10],14:[2,10],15:[2,10],16:[2,10],18:[2,10],20:[2,10],21:[2,10],22:[2,10],23:[2,10],26:[2,10],27:[2,10],31:[2,10]},{5:[2,12],7:[2,12],8:[2,12],13:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12],20:[2,12],21:[2,12],22:[2,12],23:[2,12],26:[2,12],27:[2,12],31:[2,12]},{17:[1,18]},{17:[1,19]},{17:[1,20]},{1:[2,1]},{5:[2,3],7:[2,3],8:[2,3],13:[2,3],15:[2,3],16:[2,3],20:[2,3],21:[2,3],22:[2,3],23:[2,3],26:[2,3],27:[2,3]},{13:[1,21]},{9:22,13:[1,10],15:[1,11]},{13:[1,23]},{28:[1,24]},{5:[2,11],7:[2,11],8:[2,11],13:[2,11],14:[2,11],15:[2,11],16:[2,11],18:[2,11],20:[2,11],21:[2,11],22:[2,11],23:[2,11],26:[2,11],27:[2,11],31:[2,11]},{14:[1,17],18:[1,25]},{24:[1,26]},{18:[1,28],29:27,30:29,31:[1,30]},{4:31,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{9:32,13:[1,10],15:[1,11]},{18:[1,33],30:34,31:[1,30]},{5:[2,21],7:[2,21],8:[2,21],13:[2,21],15:[2,21],16:[2,21],20:[2,21],21:[2,21],22:[2,21],23:[2,21],26:[2,21],27:[2,21]},{18:[2,24],31:[2,24]},{9:35,13:[1,36],15:[1,11]},{6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],19:37,20:[1,38],21:[1,39],22:[1,40],23:[1,13],27:[1,14]},{14:[1,17],18:[1,41]},{5:[2,20],7:[2,20],8:[2,20],13:[2,20],15:[2,20],16:[2,20],20:[2,20],21:[2,20],22:[2,20],23:[2,20],26:[2,20],27:[2,20]},{18:[2,25],31:[2,25]},{14:[1,17],18:[2,22],31:[2,22]},{14:[2,10],18:[2,10],31:[2,10],32:[1,42]},{5:[2,13],7:[2,13],8:[2,13],13:[2,13],15:[2,13],16:[2,13],20:[2,13],21:[2,13],22:[2,13],23:[2,13],26:[2,13],27:[2,13]},{5:[2,14],7:[2,14],8:[2,14],13:[2,14],15:[2,14],16:[2,14],20:[2,14],21:[2,14],22:[2,14],23:[2,14],26:[2,14],27:[2,14]},{4:43,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{17:[1,44]},{4:45,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{9:46,13:[1,10],15:[1,11]},{6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],20:[1,47],23:[1,13],27:[1,14]},{9:48,13:[1,10],15:[1,11]},{6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],21:[1,51],23:[1,13],25:49,26:[1,50],27:[1,14]},{14:[1,17],18:[2,23],31:[2,23]},{5:[2,15],7:[2,15],8:[2,15],13:[2,15],15:[2,15],16:[2,15],20:[2,15],21:[2,15],22:[2,15],23:[2,15],26:[2,15],27:[2,15]},{14:[1,17],18:[1,52]},{5:[2,17],7:[2,17],8:[2,17],13:[2,17],15:[2,17],16:[2,17],20:[2,17],21:[2,17],22:[2,17],23:[2,17],26:[2,17],27:[2,17]},{5:[2,18],7:[2,18],8:[2,18],13:[2,18],15:[2,18],16:[2,18],20:[2,18],21:[2,18],22:[2,18],23:[2,18],26:[2,18],27:[2,18]},{4:53,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{4:54,6:3,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],27:[1,14]},{6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],23:[1,13],26:[1,55],27:[1,14]},{6:16,7:[1,4],8:[1,5],9:6,10:7,11:8,12:9,13:[1,10],15:[1,11],16:[1,12],19:56,20:[1,38],21:[1,39],22:[1,40],23:[1,13],27:[1,14]},{5:[2,19],7:[2,19],8:[2,19],13:[2,19],15:[2,19],16:[2,19],20:[2,19],21:[2,19],22:[2,19],23:[2,19],26:[2,19],27:[2,19]},{5:[2,16],7:[2,16],8:[2,16],13:[2,16],15:[2,16],16:[2,16],20:[2,16],21:[2,16],22:[2,16],23:[2,16],26:[2,16],27:[2,16]}],defaultActions:{15:[2,1]},parseError:function(b,c){throw new Error(b)},parse:function(b){function p(a){d.length=d.length-2*a,e.length=e.length-a,f.length=f.length-a}function q(){var a;return a=c.lexer.lex()||1,typeof a!="number"&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0,l=2,m=1;this.lexer.setInput(b),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var n=this.lexer.yylloc;f.push(n);var o=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var r,s,t,u,v,w,x={},y,z,A,B;for(;;){t=d[d.length-1];if(this.defaultActions[t])u=this.defaultActions[t];else{if(r===null||typeof r=="undefined")r=q();u=g[t]&&g[t][r]}if(typeof u=="undefined"||!u.length||!u[0]){var C="";if(!k){B=[];for(y in g[t])this.terminals_[y]&&y>2&&B.push("'"+this.terminals_[y]+"'");this.lexer.showPosition?C="Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+B.join(", ")+", got '"+(this.terminals_[r]||r)+"'":C="Parse error on line "+(i+1)+": Unexpected "+(r==1?"end of input":"'"+(this.terminals_[r]||r)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[r]||r,line:this.lexer.yylineno,loc:n,expected:B})}}if(u[0]instanceof Array&&u.length>1)throw new Error("Parse Error: multiple actions possible at state: "+t+", token: "+r);switch(u[0]){case 1:d.push(r),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(u[1]),r=null,s?(r=s,s=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,n=this.lexer.yylloc,k>0&&k--);break;case 2:z=this.productions_[u[1]][1],x.$=e[e.length-z],x._$={first_line:f[f.length-(z||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(z||1)].first_column,last_column:f[f.length-1].last_column},o&&(x._$.range=[f[f.length-(z||1)].range[0],f[f.length-1].range[1]]),w=this.performAction.call(x,h,j,i,this.yy,u[1],e,f);if(typeof w!="undefined")return w;z&&(d=d.slice(0,-1*z*2),e=e.slice(0,-1*z),f=f.slice(0,-1*z)),d.push(this.productions_[u[1]][0]),e.push(x.$),f.push(x._$),A=g[d[d.length-2]][d[d.length-1]],d.push(A);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(b,c){if(this.yy.parser)this.yy.parser.parseError(b,c);else throw new Error(b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);c.length||(c=["",""]),this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);d.length||(d=["",""]),this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=(new Array(a.length+1)).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e,f;this._more||(this.yytext="",this.match="");var g=this._currentRules();for(var h=0;h<g.length;h++){c=this._input.match(this.rules[g[h]]);if(c&&(!b||c[0].length>b[0].length)){b=c,d=h;if(!this.options.flex)break}}if(b){f=b[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,g[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(a)return a;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)},options:{},performAction:function(b,c,d,e){var f=e;switch(d){case 0:return this.begin("directive"),16;case 1:return this.begin("directive"),21;case 2:return this.begin("directive"),"ELSIF";case 3:return this.begin("directive"),20;case 4:return this.begin("directive"),23;case 5:return this.begin("directive"),26;case 6:return 8;case 7:return this.begin("directive"),this.lex();case 8:return 16;case 9:return 21;case 10:return 22;case 11:return 20;case 12:return 23;case 13:return 26;case 14:return this.begin("call"),27;case 15:return 13;case 16:return 14;case 17:return this.begin("idirective"),17;case 18:return 5;case 19:return this.popState(),this.less(),this.lex();case 20:return 24;case 21:return 15;case 22:return 13;case 23:break;case 24:return 14;case 25:return 31;case 26:return 32;case 27:return this.popState(),this.popState(),18;case 28:return 17;case 29:return this.popState(),this.begin("idirective"),31;case 30:return this.popState(),this.popState(),18;case 31:return 28;case 32:return 7;case 33:return 7;case 34:return 5}},rules:[/^(?:\n *@if\b)/,/^(?:\n *@else\b)/,/^(?:\n *@elsif\b)/,/^(?:\n *@endif\b)/,/^(?:\n *@for\b)/,/^(?:\n *@endfor\b)/,/^(?:@@)/,/^(?:@)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:elseif\b)/,/^(?:endif\b)/,/^(?:for\b)/,/^(?:endfor\b)/,/^(?:call\b)/,/^(?:\w+)/,/^(?:\.)/,/^(?:\()/,/^(?:$)/,/^(?:(.|\n))/,/^(?: in )/,/^(?:\d+)/,/^(?:\w+)/,/^(?:\s+)/,/^(?:\.)/,/^(?:,)/,/^(?:=)/,/^(?:\))/,/^(?:\()/,/^(?:,)/,/^(?:\))/,/^(?:[\w\.\/]+)/,/^(?:([^@]+)(?=\n\s*))/,/^(?:[^@]+)/,/^(?:$)/],conditions:{call:{rules:[28,29,30,31],inclusive:!1},idirective:{rules:[20,21,22,23,24,25,26,27],inclusive:!1},directive:{rules:[8,9,10,11,12,13,14,15,16,17,18,19],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,32,33,34],inclusive:!0}}};return a}();return a.lexer=b,c.prototype=a,a.Parser=c,new c}();Mockle.Parser=a}),Mockle.module("Scope",[],{initialize:function(){this.layers=[]},push:function(a){this.layers.push(a)},pop:function(){this.layers.pop()},find:function(a){var b=this.layers.length;while(b--){var c=this.layers[b],d=this.lookup(a,c);if(typeof d!="undefined")return d}},lookup:function(a,b){if(typeof b!="object")return;var c=b[a];return c},partial:function(a,b){var c=this.directory.templates[a];return c.render(b)},sub:function(){var a=Mockle.Scope.create();return a.push(this.layers[0]),a.directory=this.directory,a}}),Mockle.module("Source",["mockie"],{initialize:function(){document.write("<style>*{display:none !important}</style>"),document.write('<noframes id="_mockle_tmpl">')},get:function(){return this.source||(this.source=this.fetchSelf()||"(could not extract template)"),this.source},fetchSelf:function(){var a=document.getElementById("_mockle_tmpl");if(a.innerText)return a.innerText;var b=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;return b.open("GET",location.href,!1),b.send(),this.extract(b.responseText)},fetch:function(a,b){var c=this;try{if(location.protocol=="file:")throw"nope";var d=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;d.open("GET",a,!0),d.onreadystatechange=function(){d.readyState==4&&(d.status!=200?b("HTTP "+d.status):b(null,c.extract(d.responseText)))},d.send()}catch(e){Mockie.request(a,"source",b)}},extract:function(a){var b=a.match(/^([\S\s]*?)<script([^>]*)>([\S\s]*?)<\/script>([\S\s]*)$/);if(b)return b[4]}}),Mockle.module("Template",["Parser"],{initialize:function(a,b){this.name=a,this.source=b,this.ast=Mockle.Parser.parse(b)},err:function(a,b){throw{template:this,msg:a,loc:b}},render:function(a){return this.evaluate(this.ast,a)},evaluate:function(a,b){switch(a.type){case"contents":var c="";for(var d=0;d<a.children.length;d++)c+=this.evaluate(a.children[d],b)||"";return c;case"html":return a.value;case"text":var e=this.evaluate(a.value,b);if(e&&!e.html_safe)return this.escape(e);return e;case"lookup":var e;return a.base?e=b.lookup(a.name,this.evaluate(a.base,b)):e=b.find(a.name),typeof e=="undefined"&&this.err("Undefined value: "+a.name,a.loc),e;case"for":var e=this.evaluate(a.expr,b);if(e&&e.length){var c="",f={};b.push(f);for(var d=0;d<e.length;d++)f[a.name]=e[d],c+=this.evaluate(a.body,b);return b.pop(),c}if(a.ebranch)return this.evaluate(a.ebranch,b);return;case"if":var g=this.evaluate(a.cond,b);if(g)return this.evaluate(a.tbranch,b);if(a.fbranch)return this.evaluate(a.fbranch,b);return;case"call":var h=b.sub(),i={};h.push(i);for(var d=0;d<a.args.length;d++){var j=a.args[d];i[j[1]]=this.evaluate(j[2],b)}return b.partial(a.name,h);default:throw"Unhandled: "+a.type}},escape:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},extractPartials:function(a,b){b=b||this.ast;switch(b.type){case"contents":for(var c=1;c<b.children.length;c++)this.extractPartials(a,b.children[c]);return;case"html":case"text":case"lookup":return;case"for":this.extractPartials(a,b.body),b.ebranch&&this.extractPartials(a,b.ebranch);return;case"if":this.extractPartials(a,b.tbranch),b.ebranch&&this.extractPartials(a,b.ebranch);return;case"call":a.require(b.name);return;default:throw"Unhandled: "+b[0]}}}),Mockle.module("TemplateDirectory",["Template"],{initialize:function(){this.pending=1,this.loading={},this.loaded={},this.templates={}},start:function(){--this.pending==0&&this.done()},load:function(){throw"load must be overriden"},define:function(a,b){this.templates[a]=b,this.loaded[a]=!0,this.loading[a]&&(this.start(),delete this.loading[a])},defineTemplate:function(a,b){var c=Mockle.Template.create(a,b);this.define(a,c),c.extractPartials(this)},require:function(a){if(this.loaded[a]||this.loading[a])return;this.loading[a]=!0,this.pending++,this.load(a)}}),Mockle.define("mockie",["JSON"],function(){(function(ctx){function parseJSON(str){try{return eval("("+str+")")}catch(err){return{}}}function escapeHTML(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function buildFrame(a,b){var c=buildPayload(b),d=/MSIE (6|7|8|9)/.test(navigator.userAgent)?document.createElement('<iframe name="'+escapeHTML(c)+'">'):document.createElement("iframe");return d.src=a,d.name=c,d.setAttribute("style","position:absolute;top:0;left:-100px;width:1px;height:1px"),d}var prevMockie=ctx.Mockie,M=ctx.Mockie={};M.noConflict=function(){return ctx.Mockie=prevMockie,M};var namePrefix=":mockie:",buildPayload=M.buildPayload=function(a){return namePrefix+JSON.stringify(a)},scripts=document.getElementsByTagName("script"),me=M.element=scripts[scripts.length-1],par=me.parentElement;Mockie.config=parseJSON(me.innerHTML);var idx=ctx.name.search(namePrefix);if(idx==-1)M.payload={};else{var payload=ctx.name.substring(idx+namePrefix.length);M.payload=parseJSON(payload)}M.expose=function(a){if(M.payload.request){var b=M.payload.request;throw b.args.push(function(a){var c=buildFrame(b.caller+"?q=1",{id:M.payload.id,response:a});par.appendChild(c)}),a[b.name].apply(ctx,b.args),ctx.onerror=function(){return!0},""}if(M.payload.response){var c=ctx.parent.parent;c.MOCKIE_RECEIVE(M.payload.id,M.payload.response),ctx.location='javascript:""'}};var callbacks={},genId=0;ctx.MOCKIE_RECEIVE=function(a,b){callbacks[a](null,b)},M.request=function(a,b,c,d){function e(a,b){if(h)return;h=!0,delete callbacks[f],d(a,b)}d||(d=c,c=[]);var f=genId++,g={caller:ctx.location.toString(),name:b,args:c},h=!1,i=buildFrame(a,{id:f,request:g});setTimeout(function(){e("timeout")},3e3),callbacks[f]=e,par.appendChild(i)}})(this)}),Mockle.define("JSON",[],function(){typeof JSON!="object"&&(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()}),Mockle.module("Browser",["mockie","Source","Template","Scope","TemplateDirectory"],{setup:function(){Mockie.expose({source:function(a){var b=Mockle.Source.create(),c=!0;window.onload=function(){a(b.get())}}});var a=Mockie.element;this.data={},this.defs={},this.root=a.src.replace(/(^|\/)[^\/]+$/,"$1"),this.name=location.toString().substring(this.root.length),this.scriptCounter=0,this.configs=[];var b=this;Mockle.loadedScript=function(){b.loadedScript()},Mockle.include=function(a){b.include(a)},Mockle.config=function(a){b.configs.push(a)},this.include("mockle.config.js"),window.onload=function(){var a;while(a=b.configs.shift())a(b);Mockie.config.set&&b.merge(Mockie.config.set);var c=Mockie.config.use;c&&(c=c.split(" "));for(var d=0;c&&d<c.length;d++){var e=b.defs[c[d]]();e&&b.merge(e)}b.start()}},path:function(a){return this.root+a},loadedScript:function(){--this.scriptCounter==0&&(this.source=Mockle.Source.create())},include:function(a){this.scriptCounter++,document.write('<script src="'+this.escapeHTML(this.path(a))+'"></script>'),document.write("<script>Mockle.loadedScript()</script>")},defaults:function(a){this.merge(a)},merge:function(a){for(var b in a)a.hasOwnProperty(b)&&(this.data[b]=a[b])},define:function(a,b){if(typeof b!="function"){var c=this,d=b;b=function(){c.merge(d)}}this.defs[a]=b},html:function(a){var b=Object(a);return b.html_safe=!0,b},start:function(){var a=this,b=Mockie.config.layout,c=Mockle.TemplateDirectory.create();c.load=function(b){a.source.fetch(b,function(a,d){if(a)return alert(b+" failed: "+a);c.defineTemplate(b,d)})},c.done=function(){a.process(a.name,c,b)},b&&c.require(b),c.defineTemplate(a.name,a.source.get()),c.start()},process:function(a,b,c){var d=Mockle.Scope.create();d.directory=b,d.push(this.data);var e=b.templates[a];try{var f=e.render(d);c&&(d.push({content:this.html(f)}),f=b.templates[c].render(d))}catch(g){f=this.reportError(g.template,g.msg,g.loc)}this.write(f)},reportError:function(a,b,c){var d="<style>.error { background-color: #FF6B6B;padding: 5px 10px;} .no { float: left; width: 10px; padding: 0 20px; text-align: right; color: #999 }.line { clear: both; line-height: 1.5; height: 1.5em; border-bottom: 1px solid #eee }</style>",e='<div class="line">',f="</div>",g=f+e,h=d+"<pre>"+a.name+"<br>",i=a.source.split("\n");for(var j=0;j<i.length;j++){var k=i[j],l=j+1;h+=e+'<div class="no">'+l+"</div>",h+=this.escapeHTML(k),h+=f,c.first_line==l&&(h+=e+'<div class="no">&nbsp;</div>',h+=Array(c.first_column).join("&nbsp;"),h+='<span class="error">'+b+"</span>",h+=f)}return h},escapeHTML:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},write:function(a){setTimeout(function(){document.open(),document.write("<!DOCTYPE html>"+a),document.close()})}});